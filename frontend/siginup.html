<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign up — Nykaa Demo Shop</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"/>
  <style>
    :root{--accent:#e80087;--bg:#fff6fb;--dark:#111;--muted:#6b6b6b}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;background:linear-gradient(180deg,#fff,#fff6fb);min-height:100vh;display:grid;place-items:center;padding:24px}
    .card{width:380px;background:#fff;border-radius:14px;box-shadow:0 12px 40px rgba(0,0,0,0.08);padding:22px}
    h2{margin:0 0 6px;color:var(--dark)}
    p.lead{margin:0 0 16px;color:var(--muted);font-size:14px}

    label{display:block;font-size:13px;color:var(--muted);margin-top:10px}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid #eee;margin-top:6px;font-size:15px}
    .row{display:flex;gap:10px}
    .small{font-size:12px;color:var(--muted)}

    .btn{width:100%;padding:11px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-weight:700;margin-top:14px;cursor:pointer}
    .alt{background:#fff;border:1px solid #eee;color:var(--dark)}

    .socials{display:flex;gap:8px;margin-top:12px}
    .socials button{flex:1;padding:8px;border-radius:10px;border:1px solid #eee;background:#fff;cursor:pointer}

    .msg{margin-top:10px;font-size:14px;text-align:center}

    footer{margin-top:12px;text-align:center;font-size:13px;color:var(--muted)}

    @media (max-width:420px){.card{width:100%}}
  </style>
</head>
<body>
  <div class="card" role="form" aria-label="Sign up form">
    <h2>Create your account</h2>
    <p class="lead">Join Nykaa Demo Shop — Register now to get started!</p>

    <form id="signupForm" autocomplete="on">
      <label for="name">Full Name</label>
      <input id="name" name="name" placeholder="Enter your full name" required>

      <label for="age">Age</label>
      <input id="age" name="age" type="number" min="1" max="120" placeholder="Enter your age" required>

      <label for="phone">Phone Number</label>
      <input id="phone" name="phone" type="tel" placeholder="+91 9xxxxxxxxx" required>

      <label for="email">Email</label>
      <input id="email" name="email" type="email" placeholder="you@example.com" required>

      <label for="address">Address</label>
      <input id="address" name="address" placeholder="Enter your full address" required>

      <label for="password">Password</label>
      <input id="password" name="password" type="password" placeholder="At least 6 characters" required>

      <button class="btn" type="submit">Register</button>
    </form>

    <div class="msg" id="msg" aria-live="polite"></div>


    <footer>Already have account? <a href="signin.html">Sign in</a></footer>
  </div>

<script>
// Registration form handler
const form = document.getElementById('signupForm');
const msg = document.getElementById('msg');

function showMessage(text, color) {
  msg.style.color = color || '#333';
  msg.textContent = text;
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const name = form.name.value.trim();
  const age = form.age.value.trim();
  const phone = form.phone.value.trim();
  const email = form.email.value.trim();
  const address = form.address.value.trim();
  const password = form.password.value;

  // Validation
  if (!name || !age || !phone || !email || !address || password.length < 6) {
    showMessage('Please fill all fields. Password must be at least 6 characters.', 'crimson');
    return;
  }

  showMessage('Registering...', '#666');

  try {
    // Wait for Firebase to be initialized
    if (typeof firebase === 'undefined' || !firebase.auth) {
      showMessage('Firebase not loaded. Please refresh the page.', 'crimson');
      return;
    }

    // Create user with Firebase Authentication
    const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
    const user = userCredential.user;

    // Update user profile with display name
    await firebase.auth().currentUser.updateProfile({
      displayName: name
    });

    // Save user data to Firestore
    await firebase.firestore().collection('users').doc(user.uid).set({
      name: name,
      age: parseInt(age),
      phone: phone,
      email: email,
      address: address,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });

    showMessage('Registration successful! Redirecting to login...', 'green');
    
    // Redirect to login page after 1.5 seconds
    setTimeout(() => {
      window.location.href = './signin.html';
    }, 1500);

  } catch (error) {
    console.error('Registration error:', error);
    let errorMessage = 'Registration failed. ';
    if (error.code === 'auth/email-already-in-use') {
      errorMessage += 'Email is already registered.';
    } else if (error.code === 'auth/weak-password') {
      errorMessage += 'Password is too weak.';
    } else if (error.code === 'auth/invalid-email') {
      errorMessage += 'Invalid email address.';
    } else {
      errorMessage += error.message;
    }
    showMessage(errorMessage, 'crimson');
  }
});
</script>
<!-- Firebase v8 (namespaced) - easiest for a single script file setup -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="js/firebase-config.js"></script>
<script src="js/main.js"></script>

</body>
</html>
